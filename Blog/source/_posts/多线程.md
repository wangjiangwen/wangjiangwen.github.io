---
title: 多线程
date: 2021-02-01 04:43:30
tags:
---

## 线程的概念

线程是操作系统能够进行运算调度的最小单位。作为系统调度和分派的基本单位。

## 进程和线程的区别和联系

进程是资源分配的最小单位，线程是运算调度的最小单位。

1) 一个程序至少有一个进程，一个进程至少有一个线程。

2) 一个进程可以并发多个线程，同一进程中的多条线程将共享该进程中的全部资源，如虚拟地址空间，文件描述符号和信号处理等等。但同一进程中的多个线程有各自的调用栈（call stack），自己的寄存器环境（register context），自己的线程本地存储（local storage）。

3) 进程结束后，该进程下的所有线程将销毁，而一个线程的结束不会影响同一个进程下的其他线程。

4) 线程是轻量级的进程，它的创建和销毁所需要的时间比进程小很多，所有操作系统的执行功能都是通过线程去完成的。

5) 线程在执行时时同步和互斥的，因为他们共享同一进程下的资源。

6) 在操作系统中，进程是拥有系统资源的独立单元，它可以拥有自己的资源，一般而言，线程不能拥有自己的资源，但是它能够访问其隶属进程的资源。

​    一个进程可以定义程序的一个实例。在Win32中，进程并不执行什么，它只是占据应用程序所使用的地址空间。为了让进程完成一定的工作，进程必须至少占有一个线程，正是这个线程负责包含进程地址空间中的代码。实际上，一个进程可以包含几个线程，它们可以同时执行进程地址空间中的代码。为了做到这一点，每个线程都有自己的一组CPU寄存器和堆栈。每个进程中都至少有一个线程在执行其地址空间中的代码。如果没有线程执行进程地址空间中的代码，进程也就没有继续存在的理由，系统将自动清除进程及其他地址空间。

## 常用的线程

NSThread

NSOperation

GCD

## GCD线程

### dispatch_group

### dispatch_barrier

### dispatch_semaphore



## 锁

互斥锁：NSLock

条件锁：NSConditionLock

自旋锁

读写锁

递归锁

## 问题



### 1. 线程在内存中会占用什么资源

线程拥有自己的私有内存。从深入理解虚拟机书中可知 JDK1.7中的线程私有内存包括JAVA虚拟机栈、本地方法栈、程序计数器，每当你创建一个新的线程那么它就拥有这一部分的空间。而系统分配给每个进程的内存是有限的，当创建的线程数过多，就会导致内存溢出。

### 2. 线程的数量会收到什么限制？

受内存限制。

### 3.线程切换



### 4.如何解决多线程的临界区问题？

一般通过加锁来保证读取安全 可以用串行读取或者加栅栏，一个操作完下一个才能操作，同时操作分隔开。 

### 5.锁和信号量有什么区别？ 

信号量为1的情况下相当于锁，一个是信号量+1方法，一个是-1方法。信号量多的情况下不会加锁，标识有多个任务在处理数据。锁是来对数据确保安全性访问。

### 6.如何获取线程调用栈







